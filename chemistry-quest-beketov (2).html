<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–•—ñ–º—ñ—á–Ω–∏–π –∫–≤–µ—Å—Ç: –¢–∞—î–º–Ω–∏—Ü—è –≤–µ–ª–∏–∫–æ–≥–æ —Ö—ñ–º—ñ–∫–∞</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.2em;
        }

        .welcome-screen {
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-screen h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .welcome-screen p {
            color: #666;
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: bold;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .progress-bar {
            background: #f0f0f0;
            height: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .letters-display {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .letter-box {
            width: 50px;
            height: 60px;
            border: 3px solid #667eea;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8em;
            font-weight: bold;
            color: #667eea;
            background: white;
            transition: all 0.3s;
        }

        .letter-box.revealed {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            animation: letterReveal 0.5s;
        }

        @keyframes letterReveal {
            0% { transform: rotateY(0deg); }
            50% { transform: rotateY(90deg); }
            100% { transform: rotateY(0deg); }
        }

        .task-container {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .task-title {
            color: #667eea;
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .task-content {
            color: #333;
            line-height: 1.8;
            font-size: 1.1em;
        }

        .crossword {
            display: grid;
            gap: 15px;
            margin: 20px 0;
        }

        .crossword-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .crossword-item strong {
            color: #667eea;
        }

        .rebus {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
            margin: 20px 0;
            font-size: 2em;
        }

        .rebus-item {
            padding: 15px 25px;
            background: white;
            border-radius: 10px;
            border: 2px solid #667eea;
            font-weight: bold;
        }

        .riddle {
            background: white;
            padding: 20px;
            border-radius: 10px;
            font-style: italic;
            color: #555;
            border-left: 4px solid #764ba2;
            margin: 20px 0;
        }

        .answer-input {
            margin-top: 20px;
        }

        .answer-input input {
            width: 100%;
            padding: 15px;
            font-size: 1.1em;
            border: 2px solid #ddd;
            border-radius: 10px;
        }

        .feedback {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-weight: bold;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }

        .final-screen {
            text-align: center;
        }

        .final-screen h2 {
            color: #667eea;
            font-size: 2.2em;
            margin-bottom: 20px;
        }

        .scientist-photo {
            width: 250px;
            height: 300px;
            margin: 30px auto;
            border-radius: 15px;
            border: 5px solid #667eea;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
        }

        .biography {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            text-align: left;
            margin-top: 20px;
        }

        .biography h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .biography p {
            color: #333;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .admin-panel {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .admin-toggle {
            text-align: center;
            margin-bottom: 20px;
        }

        .admin-toggle button {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .results-table th,
        .results-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .results-table th {
            background: #667eea;
            color: white;
        }

        .results-table tr:hover {
            background: #f8f9fa;
        }

        .attempts {
            display: inline-block;
            padding: 4px 8px;
            background: #ffc107;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .stat-card .number {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .letter-box {
                width: 40px;
                height: 50px;
                font-size: 1.5em;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const TASKS = [
            {
                id: 1,
                letter: '–ë',
                type: 'crossword',
                title: '–ó–∞–≤–¥–∞–Ω–Ω—è 1: –•—ñ–º—ñ—á–Ω–∏–π –∫—Ä–æ—Å–≤–æ—Ä–¥',
                questions: [
                    { clue: '1. –ú–µ—Ç–∞–ª, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ —Ç–µ—Ä–º–æ–º–µ—Ç—Ä–∞—Ö', answer: '–†–¢–£–¢–¨' },
                    { clue: '2. –ì–∞–∑, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –¥–ª—è –¥–∏—Ö–∞–Ω–Ω—è', answer: '–ö–ò–°–ï–ù–¨' },
                    { clue: '3. –ù–∞–π–ª–µ–≥—à–∏–π —Ö—ñ–º—ñ—á–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç', answer: '–í–û–î–ï–ù–¨' },
                    { clue: '4. –ú–µ—Ç–∞–ª —á–µ—Ä–≤–æ–Ω–æ–≥–æ –∫–æ–ª—å–æ—Ä—É, –¥–æ–±—Ä–∏–π –ø—Ä–æ–≤—ñ–¥–Ω–∏–∫', answer: '–ú–Ü–î–¨' }
                ],
                mainAnswer: '–†–¢–£–¢–¨',
                hint: '–ü–µ—Ä—à–∞ –ª—ñ—Ç–µ—Ä–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –ø–µ—Ä—à–µ –ø–∏—Ç–∞–Ω–Ω—è'
            },
            {
                id: 2,
                letter: '–ï',
                type: 'riddle',
                title: '–ó–∞–≤–¥–∞–Ω–Ω—è 2: –•—ñ–º—ñ—á–Ω–∞ –∑–∞–≥–∞–¥–∫–∞',
                content: '–Ø –≤ –ø–æ–≤—ñ—Ç—Ä—ñ —î –∑–∞–≤–∂–¥–∏, –±–µ–∑ –º–µ–Ω–µ –Ω–µ –ø—Ä–æ–∂–∏–≤–µ—Ç–µ. –†–æ—Å–ª–∏–Ω–∏ –º–µ–Ω–µ –≤–∏–¥—ñ–ª—è—é—Ç—å, –∞ –ª—é–¥–∏ —Ç–∞ —Ç–≤–∞—Ä–∏–Ω–∏ —Å–ø–æ–∂–∏–≤–∞—é—Ç—å. –•—Ç–æ —è?',
                answer: '–ö–ò–°–ï–ù–¨',
                hint: '–î—Ä—É–≥–∞ –ª—ñ—Ç–µ—Ä–∞ —Ü—å–æ–≥–æ –≥–∞–∑—É'
            },
            {
                id: 3,
                letter: '–ö',
                type: 'rebus',
                title: '–ó–∞–≤–¥–∞–Ω–Ω—è 3: –•—ñ–º—ñ—á–Ω–∏–π —Ä–µ–±—É—Å',
                content: ['Na + Cl =', '?'],
                answer: '–°–Ü–õ–¨',
                displayAnswer: 'NaCl',
                hint: '–¢—Ä–µ—Ç—è –ª—ñ—Ç–µ—Ä–∞ –Ω–∞–∑–≤–∏ —Ä–µ—á–æ–≤–∏–Ω–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é'
            },
            {
                id: 4,
                letter: '–ï',
                type: 'riddle',
                title: '–ó–∞–≤–¥–∞–Ω–Ω—è 4: –ó–∞–≥–∞–¥–∫–∞ –ø—Ä–æ –µ–ª–µ–º–µ–Ω—Ç',
                content: '–Ø –º–µ—Ç–∞–ª–æ–º –¥–æ—Ä–æ–≥–∏–º –Ω–∞–∑–∏–≤–∞—é—Å—å, –≤ —é–≤–µ–ª—ñ—Ä–Ω—ñ–π —Å–ø—Ä–∞–≤—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å. –•—ñ–º—ñ—á–Ω–∏–π —Å–∏–º–≤–æ–ª –º—ñ–π - Au, –∞ —è–∫ –º–µ–Ω–µ –∑–≤—É—Ç—å?',
                answer: '–ó–û–õ–û–¢–û',
                hint: '–ß–µ—Ç–≤–µ—Ä—Ç–∞ –ª—ñ—Ç–µ—Ä–∞ –Ω–∞–∑–≤–∏ —Ü—å–æ–≥–æ –º–µ—Ç–∞–ª—É'
            },
            {
                id: 5,
                letter: '–¢',
                type: 'crossword',
                title: '–ó–∞–≤–¥–∞–Ω–Ω—è 5: –û—Ä–≥–∞–Ω—ñ—á–Ω–∞ —Ö—ñ–º—ñ—è',
                questions: [
                    { clue: '1. –ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π –≤—É–≥–ª–µ–≤–æ–¥–µ–Ω—å (–º–µ—Ç–∞–Ω, –µ—Ç–∞–Ω...)', answer: '–ú–ï–¢–ê–ù' },
                    { clue: '2. –†–µ—á–æ–≤–∏–Ω–∞, —â–æ –ø—Ä–∏—Å–∫–æ—Ä—é—î —Ä–µ–∞–∫—Ü—ñ—é', answer: '–ö–ê–¢–ê–õ–Ü–ó–ê–¢–û–†' },
                    { clue: '3. –û—Å–Ω–æ–≤–∞ –æ—Ä–≥–∞–Ω—ñ—á–Ω–∏—Ö —Å–ø–æ–ª—É–∫', answer: '–ö–ê–†–ë–û–ù' },
                ],
                mainAnswer: '–ö–ê–¢–ê–õ–Ü–ó–ê–¢–û–†',
                hint: '–í–æ—Å—å–º–∞ –ª—ñ—Ç–µ—Ä–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –¥—Ä—É–≥–µ –ø–∏—Ç–∞–Ω–Ω—è'
            },
            {
                id: 6,
                letter: '–û',
                type: 'riddle',
                title: '–ó–∞–≤–¥–∞–Ω–Ω—è 6: –•—ñ–º—ñ—á–Ω–∞ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å',
                content: '–¶–µ–π –ø—Ä–æ—Ü–µ—Å –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∑ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è–º —Ç–µ–ø–ª–∞ —Ç–∞ —Å–≤—ñ—Ç–ª–∞. –î–µ—Ä–µ–≤–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ –ø–æ–ø—ñ–ª, –∞ –º–µ—Ç–∞–Ω –Ω–∞ –≤–æ–¥—É —Ç–∞ –≤—É–≥–ª–µ–∫–∏—Å–ª–∏–π –≥–∞–∑. –©–æ —Ü–µ?',
                answer: '–ì–û–†–Ü–ù–ù–Ø',
                hint: '–ü–µ—Ä—à–∞ –ª—ñ—Ç–µ—Ä–∞ —Ü—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É'
            },
            {
                id: 7,
                letter: '–í',
                type: 'rebus',
                title: '–ó–∞–≤–¥–∞–Ω–Ω—è 7: –§–æ—Ä–º—É–ª–∞ –≤–æ–¥–∏',
                content: ['H‚ÇÇ +', 'O‚ÇÇ ‚Üí', '?'],
                answer: '–í–û–î–ê',
                displayAnswer: 'H‚ÇÇO',
                hint: '–ü–µ—Ä—à–∞ –ª—ñ—Ç–µ—Ä–∞ —Ü—ñ—î—ó —Ä–µ—á–æ–≤–∏–Ω–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é'
            }
        ];

        function ChemistryQuest() {
            const [stage, setStage] = useState('welcome');
            const [studentName, setStudentName] = useState('');
            const [studentClass, setStudentClass] = useState('9');
            const [currentTaskIndex, setCurrentTaskIndex] = useState(0);
            const [revealedLetters, setRevealedLetters] = useState([]);
            const [userAnswer, setUserAnswer] = useState('');
            const [crosswordAnswers, setCrosswordAnswers] = useState({});
            const [feedback, setFeedback] = useState(null);
            const [attempts, setAttempts] = useState(0);
            const [results, setResults] = useState([]);
            const [showAdmin, setShowAdmin] = useState(false);
            const [adminPassword, setAdminPassword] = useState('');
            const [isAdminAuthenticated, setIsAdminAuthenticated] = useState(false);
            const [passwordError, setPasswordError] = useState(false);

            const ADMIN_PASSWORD = '—Ö—ñ–º—ñ—è2024'; // –ü–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –ø–∞–Ω–µ–ª—ñ –≤—á–∏—Ç–µ–ª—è

            useEffect(() => {
                const savedResults = localStorage.getItem('chemistryQuestResults');
                if (savedResults) {
                    setResults(JSON.parse(savedResults));
                }
            }, []);

            const saveResult = (studentData) => {
                const newResults = [...results, studentData];
                setResults(newResults);
                localStorage.setItem('chemistryQuestResults', JSON.stringify(newResults));
            };

            const checkAdminPassword = () => {
                if (adminPassword === ADMIN_PASSWORD) {
                    setIsAdminAuthenticated(true);
                    setShowAdmin(true);
                    setPasswordError(false);
                    setAdminPassword('');
                } else {
                    setPasswordError(true);
                    setTimeout(() => setPasswordError(false), 2000);
                }
            };

            const closeAdminPanel = () => {
                setShowAdmin(false);
                setIsAdminAuthenticated(false);
                setAdminPassword('');
            };

            const startQuest = () => {
                if (studentName.trim()) {
                    setStage('quest');
                    setAttempts(0);
                }
            };

            const checkAnswer = () => {
                const currentTask = TASKS[currentTaskIndex];
                setAttempts(prev => prev + 1);

                let isCorrect = false;

                if (currentTask.type === 'crossword') {
                    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—Å—ñ—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –∫—Ä–æ—Å–≤–æ—Ä–¥—É
                    isCorrect = currentTask.questions.every((q, idx) => {
                        const userAns = (crosswordAnswers[idx] || '').trim().toUpperCase();
                        return userAns === q.answer.toUpperCase();
                    });
                } else {
                    // –î–ª—è —ñ–Ω—à–∏—Ö —Ç–∏–ø—ñ–≤ –∑–∞–≤–¥–∞–Ω—å
                    const normalizedAnswer = userAnswer.trim().toUpperCase();
                    const correctAnswer = currentTask.answer.toUpperCase();
                    isCorrect = normalizedAnswer === correctAnswer;
                }

                if (isCorrect) {
                    setFeedback('correct');
                    setRevealedLetters([...revealedLetters, currentTask.letter]);
                    
                    setTimeout(() => {
                        if (currentTaskIndex < TASKS.length - 1) {
                            setCurrentTaskIndex(currentTaskIndex + 1);
                            setUserAnswer('');
                            setCrosswordAnswers({});
                            setFeedback(null);
                        } else {
                            saveResult({
                                name: studentName,
                                class: studentClass,
                                attempts: attempts + 1,
                                completedAt: new Date().toLocaleString('uk-UA')
                            });
                            setStage('final');
                        }
                    }, 2000);
                } else {
                    setFeedback('incorrect');
                    setTimeout(() => setFeedback(null), 2000);
                }
            };

            const renderTask = () => {
                const task = TASKS[currentTaskIndex];

                return (
                    <div className="task-container">
                        <h2 className="task-title">{task.title}</h2>
                        
                        {task.type === 'crossword' && (
                            <div className="crossword">
                                {task.questions.map((q, idx) => (
                                    <div key={idx} className="crossword-item">
                                        <strong>{q.clue}</strong>
                                        <input
                                            type="text"
                                            value={crosswordAnswers[idx] || ''}
                                            onChange={(e) => setCrosswordAnswers({
                                                ...crosswordAnswers,
                                                [idx]: e.target.value
                                            })}
                                            placeholder="–í–≤–µ–¥—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å..."
                                            style={{
                                                width: '100%',
                                                padding: '10px',
                                                marginTop: '10px',
                                                border: '2px solid #ddd',
                                                borderRadius: '6px',
                                                fontSize: '1em'
                                            }}
                                            onKeyPress={(e) => {
                                                if (e.key === 'Enter' && idx === task.questions.length - 1) {
                                                    checkAnswer();
                                                }
                                            }}
                                        />
                                    </div>
                                ))}
                                <p style={{ marginTop: '15px', color: '#667eea', fontWeight: 'bold' }}>
                                    üí° –ü—ñ–¥–∫–∞–∑–∫–∞: {task.hint}
                                </p>
                            </div>
                        )}

                        {task.type === 'riddle' && (
                            <div>
                                <div className="riddle">
                                    {task.content}
                                </div>
                                <p style={{ marginTop: '15px', color: '#667eea', fontWeight: 'bold' }}>
                                    üí° –ü—ñ–¥–∫–∞–∑–∫–∞: {task.hint}
                                </p>
                            </div>
                        )}

                        {task.type === 'rebus' && (
                            <div>
                                <div className="rebus">
                                    {task.content.map((item, idx) => (
                                        <div key={idx} className="rebus-item">{item}</div>
                                    ))}
                                </div>
                                <p style={{ marginTop: '15px', color: '#667eea', fontWeight: 'bold' }}>
                                    üí° –ü—ñ–¥–∫–∞–∑–∫–∞: {task.hint}
                                </p>
                            </div>
                        )}

                        <div className="answer-input">
                            {task.type !== 'crossword' && (
                                <input
                                    type="text"
                                    value={userAnswer}
                                    onChange={(e) => setUserAnswer(e.target.value)}
                                    placeholder="–í–≤–µ–¥—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å..."
                                    onKeyPress={(e) => e.key === 'Enter' && checkAnswer()}
                                    style={{ marginBottom: '15px' }}
                                />
                            )}
                            <button className="btn" onClick={checkAnswer}>
                                –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
                            </button>
                        </div>

                        {feedback && (
                            <div className={`feedback ${feedback}`}>
                                {feedback === 'correct' 
                                    ? `‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –í–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ –±—É–∫–≤—É "${task.letter}"` 
                                    : '‚úó –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑!'}
                            </div>
                        )}

                        <p style={{ marginTop: '20px', color: '#666', textAlign: 'center' }}>
                            –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø—Ä–æ–±: <strong>{attempts}</strong>
                        </p>
                    </div>
                );
            };

            return (
                <div className="container">
                    <div className="header">
                        <h1>üß™ –•—ñ–º—ñ—á–Ω–∏–π –∫–≤–µ—Å—Ç</h1>
                        <p className="subtitle">–¢–∞—î–º–Ω–∏—Ü—è –≤–µ–ª–∏–∫–æ–≥–æ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ–≥–æ —Ö—ñ–º—ñ–∫–∞</p>
                    </div>

                    {stage === 'welcome' && (
                        <div className="welcome-screen">
                            <h2>–í—ñ—Ç–∞—î–º–æ –≤ —Ö—ñ–º—ñ—á–Ω–æ–º—É –∫–≤–µ—Å—Ç—ñ!</h2>
                            <p>
                                –í–∞—Å —á–µ–∫–∞—é—Ç—å 7 –∑–∞—Ö–æ–ø–ª—é—é—á–∏—Ö –∑–∞–≤–¥–∞–Ω—å: –∫—Ä–æ—Å–≤–æ—Ä–¥–∏, –∑–∞–≥–∞–¥–∫–∏ —Ç–∞ —Ä–µ–±—É—Å–∏. 
                                –ö–æ–∂–Ω–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∏–∫–æ–Ω–∞–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è –≤—ñ–¥–∫—Ä–∏—î –æ–¥–Ω—É –ª—ñ—Ç–µ—Ä—É —Ç–∞—î–º–Ω–∏—á–æ–≥–æ —Å–ª–æ–≤–∞ - 
                                –ø—Ä—ñ–∑–≤–∏—â–∞ –≤–∏–¥–∞—Ç–Ω–æ–≥–æ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ–≥–æ —Ö—ñ–º—ñ–∫–∞.
                            </p>
                            <div className="input-group">
                                <label>–ü—Ä—ñ–∑–≤–∏—â–µ —Ç–∞ —ñ–º'—è:</label>
                                <input
                                    type="text"
                                    value={studentName}
                                    onChange={(e) => setStudentName(e.target.value)}
                                    placeholder="–Ü–≤–∞–Ω–µ–Ω–∫–æ –û–ª–µ–∫—Å–∞–Ω–¥—Ä"
                                />
                            </div>
                            <div className="input-group">
                                <label>–ö–ª–∞—Å:</label>
                                <select 
                                    value={studentClass} 
                                    onChange={(e) => setStudentClass(e.target.value)}
                                >
                                    <option value="9">9 –∫–ª–∞—Å</option>
                                    <option value="10">10 –∫–ª–∞—Å</option>
                                    <option value="11">11 –∫–ª–∞—Å</option>
                                </select>
                            </div>
                            <button 
                                className="btn" 
                                onClick={startQuest}
                                disabled={!studentName.trim()}
                            >
                                –†–æ–∑–ø–æ—á–∞—Ç–∏ –∫–≤–µ—Å—Ç
                            </button>
                        </div>
                    )}

                    {stage === 'quest' && (
                        <>
                            <div className="progress-bar">
                                <div 
                                    className="progress-fill" 
                                    style={{ width: `${((currentTaskIndex + 1) / TASKS.length) * 100}%` }}
                                >
                                    –ó–∞–≤–¥–∞–Ω–Ω—è {currentTaskIndex + 1} –∑ {TASKS.length}
                                </div>
                            </div>

                            <div className="letters-display">
                                {['–ë', '–ï', '–ö', '–ï', '–¢', '–û', '–í'].map((letter, idx) => (
                                    <div 
                                        key={idx} 
                                        className={`letter-box ${revealedLetters.includes(letter) && revealedLetters.indexOf(letter) <= idx ? 'revealed' : ''}`}
                                    >
                                        {revealedLetters.includes(letter) && revealedLetters.indexOf(letter) <= idx ? letter : '?'}
                                    </div>
                                ))}
                            </div>

                            {renderTask()}
                        </>
                    )}

                    {stage === 'final' && (
                        <div className="final-screen">
                            <h2>üéâ –í—ñ—Ç–∞—î–º–æ! –í–∏ —Ä–æ–∑–≥–∞–¥–∞–ª–∏ –∫–≤–µ—Å—Ç!</h2>
                            
                            <div className="letters-display" style={{ marginTop: '30px' }}>
                                {['–ë', '–ï', '–ö', '–ï', '–¢', '–û', '–í'].map((letter, idx) => (
                                    <div key={idx} className="letter-box revealed">
                                        {letter}
                                    </div>
                                ))}
                            </div>

                            <div className="scientist-photo">
                                üë®‚Äçüî¨
                            </div>

                            <div className="biography">
                                <h3>–ú–∏–∫–æ–ª–∞ –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á –ë–µ–∫–µ—Ç–æ–≤ (1827-1911)</h3>
                                <p>
                                    <strong>–í–∏–¥–∞—Ç–Ω–∏–π —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π —Ö—ñ–º—ñ–∫</strong>, –∑–∞—Å–Ω–æ–≤–Ω–∏–∫ —Ñ—ñ–∑–∏–∫–æ-—Ö—ñ–º—ñ—á–Ω–æ–≥–æ –Ω–∞–ø—Ä—è–º–∫—É –≤ —Ö—ñ–º—ñ—ó, 
                                    –∞–∫–∞–¥–µ–º—ñ–∫ –ü–µ—Ç–µ—Ä–±—É—Ä–∑—å–∫–æ—ó –∞–∫–∞–¥–µ–º—ñ—ó –Ω–∞—É–∫.
                                </p>
                                <p>
                                    <strong>–û—Å–Ω–æ–≤–Ω—ñ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è:</strong>
                                </p>
                                <p>
                                    ‚Ä¢ –í—ñ–¥–∫—Ä–∏–≤ —è–≤–∏—â–µ –≤–∏—Ç—ñ—Å–Ω–µ–Ω–Ω—è –æ–¥–Ω–∏—Ö –º–µ—Ç–∞–ª—ñ–≤ —ñ–Ω—à–∏–º–∏ –∑ —Ä–æ–∑—á–∏–Ω—ñ–≤ —ó—Ö–Ω—ñ—Ö —Å–æ–ª–µ–π 
                                    (–∞–ª—é–º–æ—Ç–µ—Ä–º—ñ—è - –º–µ—Ç–æ–¥ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –º–µ—Ç–∞–ª—ñ–≤ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è–º —ó—Ö –æ–∫—Å–∏–¥—ñ–≤ –∞–ª—é–º—ñ–Ω—ñ—î–º)
                                </p>
                                <p>
                                    ‚Ä¢ –°—Ç–≤–æ—Ä–∏–≤ –≤—á–µ–Ω–Ω—è –ø—Ä–æ –æ–∫–∏—Å–Ω–æ-–≤—ñ–¥–Ω–æ–≤–Ω—ñ –ø–æ—Ç–µ–Ω—Ü—ñ–∞–ª–∏ –º–µ—Ç–∞–ª—ñ–≤
                                </p>
                                <p>
                                    ‚Ä¢ –í–ø–µ—Ä—à–µ –≤–∏–¥—ñ–ª–∏–≤ –∫–∞–ª—å—Ü—ñ–π –µ–ª–µ–∫—Ç—Ä–æ–ª—ñ–∑–æ–º
                                </p>
                                <p>
                                    ‚Ä¢ –†–æ–∑—Ä–æ–±–∏–≤ —Ç–µ–æ—Ä—ñ—é —Ö—ñ–º—ñ—á–Ω–æ—ó –¥–∏–Ω–∞–º—ñ–∫–∏ —Ç–∞ —Ö—ñ–º—ñ—á–Ω–æ—ó –º–µ—Ö–∞–Ω—ñ–∫–∏
                                </p>
                                <p>
                                    –ë–µ–∫–µ—Ç–æ–≤ –Ω–∞—Ä–æ–¥–∏–≤—Å—è –≤ –•–∞—Ä–∫–æ–≤—ñ, –∑–∞–∫—ñ–Ω—á–∏–≤ –•–∞—Ä–∫—ñ–≤—Å—å–∫–∏–π —É–Ω—ñ–≤–µ—Ä—Å–∏—Ç–µ—Ç. –ü—Ä–∞—Ü—é–≤–∞–≤ –ø—Ä–æ—Ñ–µ—Å–æ—Ä–æ–º 
                                    —ñ —Ä–µ–∫—Ç–æ—Ä–æ–º –•–∞—Ä–∫—ñ–≤—Å—å–∫–æ–≥–æ —É–Ω—ñ–≤–µ—Ä—Å–∏—Ç–µ—Ç—É (1864-1865, 1876-1878). –ô–æ–≥–æ —Ä–æ–±–æ—Ç–∏ –∑–∞–∫–ª–∞–ª–∏ 
                                    –æ—Å–Ω–æ–≤–∏ —Å—É—á–∞—Å–Ω–æ—ó –º–µ—Ç–∞–ª—É—Ä–≥—ñ—ó —Ç–∞ –µ–ª–µ–∫—Ç—Ä–æ—Ö—ñ–º—ñ—ó.
                                </p>
                                <p style={{ marginTop: '20px', fontStyle: 'italic', color: '#667eea' }}>
                                    <strong>–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –∫–≤–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω–æ –∑–∞ {attempts} —Å–ø—Ä–æ–±(–∏)!
                                </p>
                            </div>

                            <button 
                                className="btn" 
                                style={{ marginTop: '30px' }}
                                onClick={() => window.location.reload()}
                            >
                                –ü—Ä–æ–π—Ç–∏ —â–µ —Ä–∞–∑
                            </button>
                        </div>
                    )}

                    {stage === 'welcome' && (
                        <div className="admin-panel">
                            <div className="admin-toggle">
                                {!showAdmin && (
                                    <button onClick={() => setShowAdmin(true)}>
                                        üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                                    </button>
                                )}
                                {showAdmin && !isAdminAuthenticated && (
                                    <>
                                        <h3 style={{ marginBottom: '15px', color: '#667eea' }}>
                                            üîê –î–æ—Å—Ç—É–ø –¥–ª—è –≤—á–∏—Ç–µ–ª—è
                                        </h3>
                                        <div className="input-group" style={{ maxWidth: '400px', margin: '0 auto' }}>
                                            <input
                                                type="password"
                                                value={adminPassword}
                                                onChange={(e) => setAdminPassword(e.target.value)}
                                                placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å..."
                                                onKeyPress={(e) => e.key === 'Enter' && checkAdminPassword()}
                                                style={{ marginBottom: '10px' }}
                                            />
                                            <div style={{ display: 'flex', gap: '10px', justifyContent: 'center' }}>
                                                <button 
                                                    onClick={checkAdminPassword}
                                                    style={{ 
                                                        background: '#667eea',
                                                        color: 'white',
                                                        border: 'none',
                                                        padding: '10px 20px',
                                                        borderRadius: '8px',
                                                        cursor: 'pointer'
                                                    }}
                                                >
                                                    –£–≤—ñ–π—Ç–∏
                                                </button>
                                                <button 
                                                    onClick={() => setShowAdmin(false)}
                                                    style={{ 
                                                        background: '#6c757d',
                                                        color: 'white',
                                                        border: 'none',
                                                        padding: '10px 20px',
                                                        borderRadius: '8px',
                                                        cursor: 'pointer'
                                                    }}
                                                >
                                                    –°–∫–∞—Å—É–≤–∞—Ç–∏
                                                </button>
                                            </div>
                                            {passwordError && (
                                                <div style={{ 
                                                    color: '#dc3545', 
                                                    marginTop: '10px',
                                                    fontWeight: 'bold'
                                                }}>
                                                    ‚ùå –ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å
                                                </div>
                                            )}
                                        </div>
                                    </>
                                )}
                                {showAdmin && isAdminAuthenticated && (
                                    <button onClick={closeAdminPanel}>
                                        üîí –ó–∞–∫—Ä–∏—Ç–∏ –ø–∞–Ω–µ–ª—å –≤—á–∏—Ç–µ–ª—è
                                    </button>
                                )}
                            </div>

                            {showAdmin && isAdminAuthenticated && (
                                <>
                                    <h3 style={{ marginBottom: '20px', color: '#667eea' }}>
                                        –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —É—á–Ω—ñ–≤
                                    </h3>

                                    <div className="stats">
                                        <div className="stat-card">
                                            <h4>–í—Å—å–æ–≥–æ —É—á–∞—Å–Ω–∏–∫—ñ–≤</h4>
                                            <div className="number">{results.length}</div>
                                        </div>
                                        <div className="stat-card">
                                            <h4>–°–µ—Ä–µ–¥–Ω—è –∫-—Ç—å —Å–ø—Ä–æ–±</h4>
                                            <div className="number">
                                                {results.length > 0 
                                                    ? (results.reduce((sum, r) => sum + r.attempts, 0) / results.length).toFixed(1)
                                                    : 0}
                                            </div>
                                        </div>
                                        <div className="stat-card">
                                            <h4>–ù–∞–π–∫—Ä–∞—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h4>
                                            <div className="number">
                                                {results.length > 0 
                                                    ? Math.min(...results.map(r => r.attempts))
                                                    : '-'}
                                            </div>
                                        </div>
                                    </div>

                                    {results.length > 0 ? (
                                        <table className="results-table">
                                            <thead>
                                                <tr>
                                                    <th>‚Ññ</th>
                                                    <th>–ü–Ü–ë —É—á–Ω—è</th>
                                                    <th>–ö–ª–∞—Å</th>
                                                    <th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø—Ä–æ–±</th>
                                                    <th>–î–∞—Ç–∞ –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {results.map((result, idx) => (
                                                    <tr key={idx}>
                                                        <td>{idx + 1}</td>
                                                        <td>{result.name}</td>
                                                        <td>{result.class} –∫–ª–∞—Å</td>
                                                        <td>
                                                            <span className="attempts">
                                                                {result.attempts} —Å–ø—Ä–æ–±
                                                            </span>
                                                        </td>
                                                        <td>{result.completedAt}</td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    ) : (
                                        <p style={{ textAlign: 'center', color: '#666', marginTop: '20px' }}>
                                            –ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
                                        </p>
                                    )}

                                    {results.length > 0 && (
                                        <button 
                                            className="btn" 
                                            style={{ marginTop: '20px', background: '#dc3545' }}
                                            onClick={() => {
                                                if (confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –æ—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏?')) {
                                                    setResults([]);
                                                    localStorage.removeItem('chemistryQuestResults');
                                                }
                                            }}
                                        >
                                            –û—á–∏—Å—Ç–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
                                        </button>
                                    )}
                                </>
                            )}
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<ChemistryQuest />, document.getElementById('root'));
    </script>
</body>
</html>